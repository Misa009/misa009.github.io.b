<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Notas</title>
  <style>
    :root{
      --bg:#f2f2f7;
      --panel:#ffffff;
      --line:#e5e5ea;
      --text:#111111;
      --muted:#6b6b72;
      --accent:#ffcc00;
      --accent-2:#007aff;
      --danger:#ff3b30;
      --radius:14px;
      --shadow:0 6px 20px rgba(0,0,0,.06);
      font-synthesis: style;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,sans-serif;
    }

    /* Top bar */
    .topbar{
      position:sticky; top:0; z-index:10;
      background:rgba(242,242,247,.9);
      backdrop-filter:saturate(180%) blur(18px);
      border-bottom:1px solid var(--line);
      padding:12px 14px;
      display:flex; align-items:center; gap:10px;
    }
    .topbar .title{
      font-weight:700; font-size:20px; letter-spacing:.2px;
      display:flex; align-items:center; gap:8px;
    }
    .pill{
      font-size:12px; font-weight:600; color:#000;
      background:var(--accent);
      padding:2px 8px; border-radius:999px;
    }
    .top-actions{margin-left:auto; display:flex; gap:8px;}
    .btn{
      border:0; background:var(--panel); color:var(--text);
      padding:8px 10px; border-radius:10px; box-shadow:var(--shadow);
      font-size:14px; font-weight:600; cursor:pointer;
      display:flex; align-items:center; gap:6px;
      transition:transform .05s ease, background .2s ease, opacity .2s ease;
    }
    .btn:active{transform:translateY(1px); opacity:.9;}
    .btn.primary{background:#111; color:#fff;}
    .btn.icon{width:36px; justify-content:center; padding:8px;}
    .btn.danger{background:#fff; color:var(--danger); border:1px solid #ffd0cd;}
    .btn.ghost{background:transparent; box-shadow:none; color:var(--accent-2);}

    /* Layout */
    .wrap{
      height:calc(100vh - 58px);
      display:grid;
      grid-template-columns: 360px 1fr;
      gap:12px;
      padding:12px;
    }
    @media (max-width: 900px){
      .wrap{
        grid-template-columns:1fr;
        height:auto;
      }
      .editor{
        min-height:60vh;
      }
    }

    .sidebar, .editor{
      background:var(--panel);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      overflow:hidden;
    }

    /* Sidebar header */
    .side-header{
      padding:12px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; gap:8px;
    }
    .search{
      width:100%;
      background:#f7f7fb;
      border:1px solid var(--line);
      padding:9px 10px;
      border-radius:10px;
      font-size:14px;
      outline:none;
    }
    .count{
      font-size:12px; color:var(--muted); font-weight:600;
      margin-left:auto;
      white-space:nowrap;
    }

    /* Notes list */
    .list{
      max-height:calc(100% - 54px);
      overflow:auto;
    }
    .note-item{
      padding:12px;
      border-bottom:1px solid var(--line);
      cursor:pointer;
      display:flex; flex-direction:column; gap:2px;
      transition:background .15s ease;
    }
    .note-item:hover{background:#fafafa;}
    .note-item.active{background:#fff7cc;}
    .note-title{
      font-size:15px; font-weight:700;
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
    }
    .note-meta{
      font-size:12px; color:var(--muted);
      display:flex; gap:8px;
    }
    .note-preview{
      font-size:13px; color:#2c2c2e;
      overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
    }

    /* Editor header */
    .editor-header{
      padding:10px 12px;
      border-bottom:1px solid var(--line);
      display:flex; align-items:center; gap:8px;
    }
    .editor-title{
      font-size:13px; color:var(--muted); font-weight:600;
    }
    .editor-actions{margin-left:auto; display:flex; gap:6px;}

    textarea{
      width:100%;
      height:calc(100% - 48px);
      border:0; resize:none; outline:none;
      padding:16px;
      font-size:17px; line-height:1.45;
      font-family:inherit;
      background:#fff;
    }
    .empty{
      height:100%;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      color:var(--muted); font-size:15px; gap:10px;
      padding:40px; text-align:center;
    }
    .empty .big{
      font-size:22px; font-weight:800; color:#1c1c1e;
    }
    .kbd{
      font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;
      background:#f3f3f6; border:1px solid var(--line);
      padding:2px 6px; border-radius:6px; font-size:12px;
      color:#333;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="title">
      Notas <span class="pill">iOS-style</span>
    </div>
    <div class="top-actions">
      <button class="btn ghost" id="exportBtn" title="Exportar notas">
        Exportar
      </button>
      <button class="btn primary" id="newBtn" title="Nueva nota">
        ‚úèÔ∏è Nueva nota
      </button>
    </div>
  </div>

  <div class="wrap">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="side-header">
        <input class="search" id="searchInput" placeholder="Buscar en notas" />
        <div class="count" id="countLabel">0 notas</div>
      </div>
      <div class="list" id="list"></div>
    </aside>

    <!-- Editor -->
    <section class="editor" id="editor">
      <div class="empty" id="emptyState">
        <div class="big">Sin nota seleccionada</div>
        <div>Pulsa <span class="kbd">Nueva nota</span> para empezar.</div>
      </div>
    </section>
  </div>

  <script>
    /* ----------------------------
       Notas iOS-like (single file)
       ---------------------------- */

    const STORAGE_KEY = "notas_magica_ioslike_v1";

    const seedNotes = [
      {
        title: "Marcas de coches (top)",
        body:
`Marcas de coches:
- Mercedes-Benz
- BMW
- Audi
- Volkswagen
- Porsche
- Ferrari
- Lamborghini
- Toyota
- Honda
- Hyundai
- Kia
- Renault
- Peugeot
- SEAT
- Tesla
- BYD
- Volvo
- Ford
- Chevrolet
- Lexus`
      },
      {
        title: "Canciones para rutinas",
        body:
`Canciones (ideas):
- "Billie Jean" ‚Äî Michael Jackson
- "Bohemian Rhapsody" ‚Äî Queen
- "Blinding Lights" ‚Äî The Weeknd
- "Viva la Vida" ‚Äî Coldplay
- "Shape of You" ‚Äî Ed Sheeran
- "Hysteria" ‚Äî Muse
- "Lose Yourself" ‚Äî Eminem
- "Titanium" ‚Äî David Guetta ft. Sia
- "La Flaca" ‚Äî Jarabe de Palo
- "Mi Gran Noche" ‚Äî Raphael`
      },
      {
        title: "Pa√≠ses por continentes",
        body:
`Europa:
- Espa√±a, Francia, Italia, Alemania, Portugal, Reino Unido, Suecia, Noruega, Pa√≠ses Bajos

Am√©rica:
- Canad√°, Estados Unidos, M√©xico, Colombia, Argentina, Chile, Brasil, Per√∫

√Åfrica:
- Marruecos, Egipto, Senegal, Nigeria, Sud√°frica, Kenia

Asia:
- Jap√≥n, China, Corea del Sur, India, Tailandia, Vietnam, Turqu√≠a

Ocean√≠a:
- Australia, Nueva Zelanda, Fiyi`
      },
      {
        title: "Lista r√°pida de compra",
        body:
`Compra:
- Leche
- Huevos
- Pan
- Caf√©
- Aceite de oliva
- Tomate triturado
- Pasta
- At√∫n
- Fruta (pl√°tanos, manzanas)
- Papel cocina`
      }
    ];

    let notes = [];
    let activeId = null;

    // Elements
    const listEl = document.getElementById("list");
    const editorEl = document.getElementById("editor");
    const emptyStateEl = document.getElementById("emptyState");
    const countLabel = document.getElementById("countLabel");
    const searchInput = document.getElementById("searchInput");
    const newBtn = document.getElementById("newBtn");
    const exportBtn = document.getElementById("exportBtn");

    function uid(){
      return Math.random().toString(36).slice(2) + Date.now().toString(36);
    }

    function nowTs(){ return Date.now(); }

    function firstLine(text){
      const l = (text || "").split("\n").map(s=>s.trim()).find(Boolean);
      return l || "Sin t√≠tulo";
    }

    function preview(text){
      const lines = (text || "").split("\n").map(s=>s.trim()).filter(Boolean);
      if(lines.length <= 1) return (lines[0] || "");
      return lines.slice(1).join(" ").slice(0, 90);
    }

    function load(){
      const raw = localStorage.getItem(STORAGE_KEY);
      if(!raw){
        // first run -> seed data
        notes = seedNotes.map(n => ({
          id: uid(),
          body: n.body,
          createdAt: nowTs(),
          updatedAt: nowTs()
        }));
        save();
        return;
      }
      try{
        notes = JSON.parse(raw) || [];
      }catch(e){
        notes = [];
      }
    }

    function save(){
      localStorage.setItem(STORAGE_KEY, JSON.stringify(notes));
    }

    function sortNotes(arr){
      return arr.slice().sort((a,b)=> b.updatedAt - a.updatedAt);
    }

    function fmtDate(ts){
      const d = new Date(ts);
      return d.toLocaleDateString("es-ES", { day:"2-digit", month:"short", year:"numeric" });
    }

    function renderList(){
      const q = searchInput.value.trim().toLowerCase();
      const filtered = sortNotes(notes).filter(n => (n.body || "").toLowerCase().includes(q));

      listEl.innerHTML = "";

      filtered.forEach(n => {
        const item = document.createElement("div");
        item.className = "note-item" + (n.id === activeId ? " active" : "");
        item.onclick = () => selectNote(n.id);

        const title = document.createElement("div");
        title.className = "note-title";
        title.textContent = firstLine(n.body);

        const meta = document.createElement("div");
        meta.className = "note-meta";
        meta.innerHTML = `<span>${fmtDate(n.updatedAt)}</span><span>‚Ä¢</span><span>${(n.body||"").length} caracteres</span>`;

        const prev = document.createElement("div");
        prev.className = "note-preview";
        prev.textContent = preview(n.body);

        item.appendChild(title);
        item.appendChild(meta);
        item.appendChild(prev);

        listEl.appendChild(item);
      });

      countLabel.textContent = `${filtered.length} nota${filtered.length!==1?"s":""}`;
    }

    function renderEditor(){
      editorEl.innerHTML = "";

      const note = notes.find(n => n.id === activeId);
      if(!note){
        editorEl.appendChild(emptyStateEl);
        emptyStateEl.style.display = "flex";
        return;
      }
      emptyStateEl.style.display = "none";

      const header = document.createElement("div");
      header.className = "editor-header";

      const headerTitle = document.createElement("div");
      headerTitle.className = "editor-title";
      headerTitle.textContent = fmtDate(note.updatedAt);

      const actions = document.createElement("div");
      actions.className = "editor-actions";

      const delBtn = document.createElement("button");
      delBtn.className = "btn danger";
      delBtn.textContent = "üóëÔ∏è Eliminar";
      delBtn.onclick = () => deleteActive();

      actions.appendChild(delBtn);

      header.appendChild(headerTitle);
      header.appendChild(actions);

      const ta = document.createElement("textarea");
      ta.value = note.body || "";
      ta.placeholder = "Escribe tu nota‚Ä¶";
      ta.oninput = () => {
        note.body = ta.value;
        note.updatedAt = nowTs();
        save();
        renderList();
        // update header date live
        headerTitle.textContent = fmtDate(note.updatedAt);
      };

      editorEl.appendChild(header);
      editorEl.appendChild(ta);

      // Focus cursor like iOS
      setTimeout(()=> ta.focus(), 0);
    }

    function selectNote(id){
      activeId = id;
      renderList();
      renderEditor();
    }

    function createNote(){
      const n = { id: uid(), body: "", createdAt: nowTs(), updatedAt: nowTs() };
      notes.push(n);
      save();
      activeId = n.id;
      renderList();
      renderEditor();
    }

    function deleteActive(){
      if(!activeId) return;
      const note = notes.find(n => n.id === activeId);
      const title = firstLine(note?.body || "");
      const ok = confirm(`¬øEliminar esta nota?\n\n"${title}"`);
      if(!ok) return;

      notes = notes.filter(n => n.id !== activeId);
      activeId = notes[0]?.id || null;
      save();
      renderList();
      renderEditor();
    }

    function exportNotes(){
      const data = sortNotes(notes).map(n => ({
        title: firstLine(n.body),
        body: n.body,
        updatedAt: new Date(n.updatedAt).toISOString()
      }));
      const blob = new Blob([JSON.stringify(data, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "notas-export.json";
      a.click();
      URL.revokeObjectURL(url);
    }

    // Events
    newBtn.addEventListener("click", createNote);
    exportBtn.addEventListener("click", exportNotes);
    searchInput.addEventListener("input", renderList);

    // Keyboard shortcuts (desktop)
    window.addEventListener("keydown", (e)=>{
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==="n"){
        e.preventDefault(); createNote();
      }
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==="f"){
        e.preventDefault(); searchInput.focus();
      }
    });

    // Init
    load();
    activeId = notes[0]?.id || null;
    renderList();
    renderEditor();
  </script>
</body>
</html>
